<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campfire – Redigera loggbok</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Caveat:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="../campfire-base.css">
    <style>
        #location-map {
            height: 320px;
            border-radius: 1rem;
            border: 2px solid #e5e7eb;
            z-index: 1;
        }

        .weather-pill input:checked + label {
            border-color: var(--forest);
            background: #e4efe8;
            color: var(--slate-deep);
            transform: translateY(-1px);
        }

        .chip-check input:checked + label {
            background: var(--forest);
            border-color: var(--forest);
            color: white;
        }

        .weather-icon {
            font-size: 1.25rem;
        }

        .rating-stars {
            color: #cbd5e1;
        }

        .rating-star {
            transition: color 0.2s ease;
        }

        .rating-star.is-active {
            color: var(--terracotta);
        }

        .log-photo-upload {
            position: relative;
            display: block;
        }

        .log-photo-upload input {
            position: absolute;
            inset: 0;
            opacity: 0;
            cursor: pointer;
        }

        #log-image-preview {
            display: none;
            height: 10rem;
            width: 100%;
            object-fit: cover;
            border-radius: 0.75rem;
            border: 2px solid #e5e7eb;
        }
    </style>
</head>
<body class="bg-[var(--bg-mist)] text-gray-800">

<div id="navbar-slot" data-variant="dark"></div>

<div class="deep-gradient">
    <div class="max-w-4xl mx-auto px-6 pt-24 sm:pt-28 pb-8">
        <div class="flex items-center gap-3">
            <a href="campfire-loggbok.html" class="w-9 h-9 bg-white/20 rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
            </a>
            <h1 class="text-2xl font-bold text-white">Redigera logg</h1>
        </div>
    </div>
</div>

<main class="max-w-6xl mx-auto px-5 py-10 lg:py-14">
    <div class="max-w-4xl mx-auto">
        <section class="bg-white rounded-3xl p-6 sm:p-8 card-shadow space-y-8">
            <form class="space-y-8">

                <!-- Datum -->
                <div class="grid sm:grid-cols-2 gap-4">
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Datum från</span>
                        <input type="date" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5">
                    </label>
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Datum till</span>
                        <input type="date" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5">
                    </label>
                </div>

                <hr class="border-gray-100">

                <!-- Plats -->
                <div class="space-y-4">
                    <div class="grid sm:grid-cols-3 gap-4">
                        <label class="sm:col-span-2 space-y-2 block">
                            <span class="text-sm font-semibold text-gray-700">Platsnamn</span>
                            <input id="location-search" type="text" placeholder="T.ex. Skulebergets ställplats" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5">
                        </label>
                        <div class="self-end">
                            <button id="search-location-btn" type="button" class="w-full bg-[var(--sage-green)] text-white px-5 py-2.5 rounded-full font-semibold hover:bg-[var(--forest)] transition-all text-sm">Sök plats</button>
                        </div>
                    </div>
                    <div id="location-map" aria-label="Karta för exakt platsmarkering"></div>
                    <p class="text-xs text-gray-500">Tips: skriv en plats och klicka sedan mer exakt i kartan.</p>
                </div>

                <!-- Typ av plats -->
                <div class="space-y-3">
                    <p class="text-sm font-semibold text-gray-700">Typ av plats</p>
                    <div class="chip-check flex flex-wrap gap-2">
                        <input id="place-camping" type="radio" name="place-type" class="sr-only" checked>
                        <label for="place-camping" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium cursor-pointer transition-all">Camping</label>

                        <input id="place-stallplats" type="radio" name="place-type" class="sr-only">
                        <label for="place-stallplats" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium cursor-pointer transition-all">Ställplats</label>

                        <input id="place-fricamping" type="radio" name="place-type" class="sr-only">
                        <label for="place-fricamping" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium cursor-pointer transition-all">Fricamping</label>

                        <input id="place-parkering" type="radio" name="place-type" class="sr-only">
                        <label for="place-parkering" class="px-4 py-2 rounded-full border-2 border-gray-200 text-sm font-medium cursor-pointer transition-all">Parkering</label>
                    </div>
                </div>

                <!-- Faciliteter -->
                <div class="space-y-3">
                    <p class="text-sm font-semibold text-gray-700">Faciliteter</p>
                    <div class="flex flex-wrap gap-2">
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Toa</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Dusch</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Toatömning</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Gråvattentömning</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Vatten</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>El</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Wifi</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Sopor</span></label>
                        <label class="flex items-center gap-2 px-3 py-1 bg-[#e4efe8] rounded-full text-sm cursor-pointer"><input type="checkbox" class="w-3 h-3 accent-[var(--forest)]"><span>Övernattning tillåten</span></label>
                    </div>
                </div>

                <hr class="border-gray-100">

                <!-- Körjournal -->
                <div class="grid sm:grid-cols-2 gap-4">
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Mätarställning (km)</span>
                        <input type="number" min="0" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5" placeholder="48320">
                    </label>
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Temperatur (°C)</span>
                        <input type="number" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5" placeholder="17">
                    </label>
                </div>

                <hr class="border-gray-100">

                <!-- Väder -->
                <div class="space-y-3">
                    <p class="text-sm font-semibold text-gray-700">Väder</p>
                    <div class="grid grid-cols-4 sm:grid-cols-7 gap-2 weather-pill text-sm max-w-xl">
                        <!-- Soligt -->
                        <div>
                            <input id="weather-sun" type="radio" name="weather" class="sr-only" checked>
                            <label for="weather-sun" aria-label="Soligt" title="Soligt" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-sun"></i>
                            </label>
                        </div>
                        <!-- Halvklart -->
                        <div>
                            <input id="weather-partly" type="radio" name="weather" class="sr-only">
                            <label for="weather-partly" aria-label="Halvklart" title="Halvklart" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-cloud-sun"></i>
                            </label>
                        </div>
                        <!-- Molnigt -->
                        <div>
                            <input id="weather-cloud" type="radio" name="weather" class="sr-only">
                            <label for="weather-cloud" aria-label="Molnigt" title="Molnigt" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-cloud"></i>
                            </label>
                        </div>
                        <!-- Regn -->
                        <div>
                            <input id="weather-rain" type="radio" name="weather" class="sr-only">
                            <label for="weather-rain" aria-label="Regn" title="Regn" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-cloud-rain"></i>
                            </label>
                        </div>
                        <!-- Snö -->
                        <div>
                            <input id="weather-snow" type="radio" name="weather" class="sr-only">
                            <label for="weather-snow" aria-label="Snö" title="Snö" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-snowflake"></i>
                            </label>
                        </div>
                        <!-- Blåst -->
                        <div>
                            <input id="weather-wind" type="radio" name="weather" class="sr-only">
                            <label for="weather-wind" aria-label="Blåst" title="Blåst" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-wind"></i>
                            </label>
                        </div>
                        <!-- Annat -->
                        <div>
                            <input id="weather-other" type="radio" name="weather" class="sr-only">
                            <label for="weather-other" aria-label="Annat" title="Annat" class="border-2 border-gray-200 rounded-xl h-12 flex items-center justify-center cursor-pointer transition-all">
                                <i class="weather-icon fa-solid fa-circle-question"></i>
                            </label>
                        </div>
                    </div>
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Fritext (valfritt)</span>
                        <input type="text" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5" placeholder="T.ex. dimma på morgonen">
                    </label>
                </div>

                <hr class="border-gray-100">

                <!-- Betyg & kostnader -->
                <div class="grid sm:grid-cols-3 gap-4">
                    <div class="space-y-2">
                        <span class="text-sm font-semibold text-gray-700 block">Betyg</span>
                        <div id="rating-stars" class="rating-stars flex items-center gap-1.5" role="radiogroup" aria-label="Betyg med stjärnor">
                            <label class="rating-star cursor-pointer" data-value="1" title="1 stjärna" aria-label="1 stjärna">
                                <input type="radio" name="rating" value="1" class="sr-only">
                                <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.5l2.94 5.96 6.58.96-4.76 4.64 1.12 6.56L12 17.52 6.12 20.62l1.12-6.56-4.76-4.64 6.58-.96L12 2.5z"/></svg>
                            </label>
                            <label class="rating-star cursor-pointer" data-value="2" title="2 stjärnor" aria-label="2 stjärnor">
                                <input type="radio" name="rating" value="2" class="sr-only">
                                <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.5l2.94 5.96 6.58.96-4.76 4.64 1.12 6.56L12 17.52 6.12 20.62l1.12-6.56-4.76-4.64 6.58-.96L12 2.5z"/></svg>
                            </label>
                            <label class="rating-star cursor-pointer" data-value="3" title="3 stjärnor" aria-label="3 stjärnor">
                                <input type="radio" name="rating" value="3" class="sr-only" checked>
                                <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.5l2.94 5.96 6.58.96-4.76 4.64 1.12 6.56L12 17.52 6.12 20.62l1.12-6.56-4.76-4.64 6.58-.96L12 2.5z"/></svg>
                            </label>
                            <label class="rating-star cursor-pointer" data-value="4" title="4 stjärnor" aria-label="4 stjärnor">
                                <input type="radio" name="rating" value="4" class="sr-only">
                                <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.5l2.94 5.96 6.58.96-4.76 4.64 1.12 6.56L12 17.52 6.12 20.62l1.12-6.56-4.76-4.64 6.58-.96L12 2.5z"/></svg>
                            </label>
                            <label class="rating-star cursor-pointer" data-value="5" title="5 stjärnor" aria-label="5 stjärnor">
                                <input type="radio" name="rating" value="5" class="sr-only">
                                <svg class="w-7 h-7" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.5l2.94 5.96 6.58.96-4.76 4.64 1.12 6.56L12 17.52 6.12 20.62l1.12-6.56-4.76-4.64 6.58-.96L12 2.5z"/></svg>
                            </label>
                        </div>
                    </div>
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Pris utan el (SEK)</span>
                        <input type="number" min="0" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5" placeholder="180">
                    </label>
                    <label class="space-y-2 block">
                        <span class="text-sm font-semibold text-gray-700">Pris med el (SEK)</span>
                        <input type="number" min="0" class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-2.5" placeholder="230">
                    </label>
                </div>

                <hr class="border-gray-100">

                <!-- Bild -->
                <div class="space-y-2">
                    <span class="text-sm font-semibold text-gray-700 block">Bild för loggen</span>
                    <div class="space-y-3">
                        <div class="log-photo-upload border-2 border-dashed border-gray-300 rounded-xl p-5 text-center hover:border-[var(--forest)] transition-colors">
                            <input id="log-image-input" type="file" accept="image/png,image/jpeg,image/webp" aria-label="Ladda upp bild till loggen">
                            <svg class="w-9 h-9 text-gray-300 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                            <p class="text-gray-500 text-sm font-semibold">Klicka för att ladda upp</p>
                            <p class="text-xs text-gray-400 mt-0.5">Visas ovanför anteckningarna i loggen</p>
                        </div>
                        <img id="log-image-preview" alt="Förhandsvisning av loggbild">
                    </div>
                </div>

                <hr class="border-gray-100">

                <!-- Anteckningar -->
                <label class="space-y-2 block">
                    <span class="text-sm font-semibold text-gray-700">Egna anteckningar</span>
                    <textarea class="cf-input w-full rounded-xl border-2 border-gray-200 px-4 py-3 min-h-28" placeholder="Vad var bäst? Något att tänka på nästa gång?"></textarea>
                </label>

                <hr class="border-gray-100">

                <!-- Övrigt -->
                <div class="space-y-3">
                    <p class="text-sm font-semibold text-gray-700">Övrigt</p>
                    <label class="flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl hover:border-[var(--forest)] transition-colors cursor-pointer">
                        <div>
                            <div class="font-semibold text-gray-800 text-sm">Kom hit igen</div>
                            <div class="text-xs text-gray-500">Vi kan tänka oss att åka hit igen</div>
                        </div>
                        <input type="checkbox" class="w-6 h-6 accent-[var(--forest)]">
                    </label>
                </div>

                <!-- Knappar -->
                <div class="flex flex-wrap items-center gap-3 pt-2">
                    <button type="submit" class="bg-[var(--forest)] text-white px-6 py-2.5 rounded-full font-semibold hover:bg-[var(--slate-deep)] transition-all text-sm">Spara logg</button>
                    <button type="button" class="px-4 py-2 text-red-500 hover:bg-red-50 rounded-lg transition-all text-sm font-medium">Radera logg</button>
                </div>

            </form>
        </section>
    </div>
</main>

<div id="footer-slot"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script>
    const map = L.map('location-map').setView([62.0, 15.0], 5);
    const marker = L.marker([62.0, 15.0], { draggable: true }).addTo(map);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap'
    }).addTo(map);

    map.on('click', (e) => {
        marker.setLatLng(e.latlng);
    });

    async function searchPlace() {
        const q = document.getElementById('location-search').value.trim();
        if (!q) return;

        const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}&limit=1`;
        const response = await fetch(url);
        const results = await response.json();

        if (results.length > 0) {
            const lat = Number(results[0].lat);
            const lon = Number(results[0].lon);
            map.setView([lat, lon], 13);
            marker.setLatLng([lat, lon]);
        }
    }

    document.getElementById('search-location-btn').addEventListener('click', searchPlace);
    document.getElementById('location-search').addEventListener('keydown', (event) => {
        if (event.key === 'Enter') {
            event.preventDefault();
            searchPlace();
        }
    });

    const ratingStars = document.querySelectorAll('.rating-star');
    const ratingInputs = document.querySelectorAll('input[name="rating"]');

    function updateRatingStars(value) {
        ratingStars.forEach((star) => {
            const starValue = Number(star.dataset.value);
            star.classList.toggle('is-active', starValue <= value);
        });
    }

    ratingInputs.forEach((input) => {
        input.addEventListener('change', () => {
            updateRatingStars(Number(input.value));
        });
    });

    const selectedRating = document.querySelector('input[name="rating"]:checked');
    updateRatingStars(selectedRating ? Number(selectedRating.value) : 0);

    const logImageInput = document.getElementById('log-image-input');
    const logImagePreview = document.getElementById('log-image-preview');

    logImageInput.addEventListener('change', () => {
        const file = logImageInput.files?.[0];

        if (!file) {
            logImagePreview.removeAttribute('src');
            logImagePreview.style.display = 'none';
            return;
        }

        const objectUrl = URL.createObjectURL(file);
        logImagePreview.src = objectUrl;
        logImagePreview.style.display = 'block';
    });
</script>
<script src="../components/load-components.js"></script>
</body>
</html>
